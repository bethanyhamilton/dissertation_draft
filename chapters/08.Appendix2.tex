\chapter{Moderator with Two Categories} \label{App: twocat}

Given a moderator with two categories, $C=2$, using a no-intercept model and constraining the regression coefficients to be equal, the $\mathbf{C}$ matrix has $1 \times 2$ dimensions and becomes:
 \begin{equation}
     \mathbf{C} = 
     \begin{bmatrix} 
     -1 & 1 
     \end{bmatrix}
     \nonumber
 \end{equation}
Furthermore, the $\mathbf{C}$ multiplied by the vector of regression coefficients becomes:
 \begin{equation}
     \mathbf{C} \bm{\hat{\beta}}= 
     \begin{bmatrix} 
     -1 & 1 \end{bmatrix}\begin{bmatrix}\bm{\hat{\beta}}_1 \\
     \bm{\hat{\beta}}_2 \end{bmatrix}  = \begin{bmatrix}
         \bm{\hat{\beta}}_2 - \bm{\hat{\beta} }_1
     \end{bmatrix}
     \nonumber
 \end{equation}
 which is set to equal $\begin{bmatrix}
     0 
 \end{bmatrix}$. 

 Then, to be able to find the moments of $\mathbf{V}^R$, we need to specify the true variance of $(\mathbf{C}\bm{\hat{\beta}}-\mathbf{c})$. For $C = 2$,  $\mathbf{\Omega}$ is:
 \begin{equation}
     \begin{split}
         \mathbf{\Omega}  &= \mathbf{C}Var(\bm{\hat{\beta}}) \mathbf{C}' \\
         &= \begin{bmatrix} 
      -1 & 1 
     \end{bmatrix} \times \begin{bmatrix}
         Var(\bm{\hat{\beta}}_1) & 0  \\
         0 & Var(\bm{\hat{\beta}}_2) 
     \end{bmatrix} \begin{bmatrix} 
     -1  \\
     1  
     \end{bmatrix} \\
    &= \begin{bmatrix}
        Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2) 
    \end{bmatrix} 
     \end{split}
     \nonumber
 \end{equation}
 
 The $Q$ statistic can be rewritten as: 
 \begin{equation}
     Q = \mathbf{z}'\mathbf{D}^{-1}\mathbf{z}, 
     \nonumber
 \end{equation}
 where $\mathbf{z = \mathbf{\Omega}}^{-1/2}(\mathbf{C}\bm{\hat{\beta}}-\mathbf{c}) $. For the $C=2$ case is: 
 \begin{equation}
    \begin{split}
     \mathbf{z} &= \left(\begin{bmatrix}
          Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2) 
    \end{bmatrix} \right)^{-1/2} \begin{bmatrix}
         \bm{\hat{\beta}}_2 - \bm{\hat{\beta}}_1 
     \end{bmatrix}   \\
     &= \left(\begin{bmatrix}
          \frac{1}{W_1} + \frac{1}{W_2}
    \end{bmatrix} \right)^{-1/2} \begin{bmatrix}
         \bm{\hat{\mu}}_2 - \bm{\hat{\mu}}_1 
     \end{bmatrix}   \\
     &= \frac{1}{\sqrt{\frac{1}{W_1} + \frac{1}{W_2}}} \begin{bmatrix}
         \bm{\hat{\mu}}_2 - \bm{\hat{\mu}}_1 
     \end{bmatrix}   \\
    \end{split}
     \nonumber
 \end{equation}
and the normalized variance of the test statistic (scaled by true sampling variance) is:  $\mathbf{D} = \mathbf{\Omega}^{-1/2}\mathbf{C}\mathbf{V}^R\mathbf{C}'\mathbf{\Omega}^{-1/2}$. For our 2-category case: 
 \begin{equation}
    \begin{split}
       \mathbf{D} &=\left(\begin{bmatrix}
        Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2) 
    \end{bmatrix} \right)^{-1/2} 
      \begin{bmatrix} 
     -1 & 1 
     \end{bmatrix} \begin{bmatrix}
         V^R_1 & 0 \\
         0& V^R_2 
     \end{bmatrix}
     \begin{bmatrix} 
     -1 \\
     1 
     \end{bmatrix} 
     \left(\begin{bmatrix}
        Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2 )
    \end{bmatrix} \right)^{-1/2} \\
    &=\left(\begin{bmatrix}
        Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2) 
    \end{bmatrix} \right)^{-1/2} 
       \begin{bmatrix}
        V^R_1 + V^R_2 
    \end{bmatrix}
     \left(\begin{bmatrix}
        Var(\bm{\hat{\beta}}_1) + Var(\bm{\hat{\beta}}_2) 
    \end{bmatrix} \right)^{-1/2} \\
    & = \frac{V^R_1 + V^R_2 }{\frac{1}{W_1} + \frac{1}{W_2} }
    \end{split} 
    \nonumber
 \end{equation}

Plugging in the $\mathbf{z}$ and $\mathbf{D}$ in the equation for $Q$-statistic (Equation \ref{eq: Q stat reformulation}),  the $Q$-statistic reduces to  $t^2$-statistic, so the $t$-statistic formulation is :
\begin{equation}
    \begin{split}
        Q &= \left[\frac{\mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1}{\sqrt{\frac{1}{W_1} + \frac{1}{W_2}}} \right]' \left( \frac{V^R_1 + V^R_2 }{\frac{1}{W_1} + \frac{1}{W_2} }  \right)^{-1} \left[\frac{ \mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1 }{\sqrt{\frac{1}{W_1} + \frac{1}{W_2}}}   \right] \\
         &= \frac{\left(\mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1  \right)^2 \left(\frac{1}{W_1} + \frac{1}{W_2}\right) }{\left(V^R_1 + V^R_2 \right)\left(\frac{1}{W_1} + \frac{1}{W_2}\right)} \\
         &= \frac{\left(\mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1  \right)^2}{\left(V^R_1 + V^R_2 \right)} \\
         \sqrt{Q} &= t = \sqrt{\frac{\left(\mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1  \right)^2}{\left(V^R_1 + V^R_2 \right)}} \\
         t &= \frac{\left(\mathbf{\hat{\mu}}_2 - \mathbf{\hat{\mu}}_1  \right)}{\sqrt{\left(V^R_1 + V^R_2 \right)} } \\
    \end{split}
    \nonumber
\end{equation}
  
\section{Moments of D}

To find the Satterthwaite degrees of freedom for a categorical moderator with two categories, I define the moments of $D$ below:
\begin{equation}
    \begin{split}
        D & = \frac{V^R_1 + V^R_2 }{\frac{1}{W_1} + \frac{1}{W_2} } \\
        & = \left(\frac{1}{W_1} + \frac{1}{W_2}\right)^{-1} \left(V^R_1 + V^R_2  \right) \\
        & = \left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-1} \left(V^R_1 + V^R_2  \right) \\
        E(D) & = \left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-1} \left(E(V^R_1) + E(V^R_2)  \right) \\
         Var(D) & = \left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-2 } \left(Var(V^R_1) + Var(V^R_2)  \right) \\
    \end{split}
    \nonumber
\end{equation}

\section{Satterthwaite Degrees of Freedom for C = 2}


Using the equation for the Satterthwaite degrees of freedom (Equation \ref{eq: satt formulation}), we obtain the Satterthwaite degrees of freedom for a categorical moderator with two categories:

\begin{equation}
    \begin{split}
        \zeta_{c = 2} & = \frac{2 \times [E(V^R)]^2}{Var(V^R)} \\
              & = \frac{2 \times \left[\left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-1} \left(E(V^R_1) + E(V^R_2)  \right) \right]^2}{\left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-2 } \left(Var(V^R_1) + Var(V^R_2)  \right)} \\
              & = \frac{2}{\left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{-2 } \times (Var(V_1^R) + Var(V_2^R))} \\
              & = \frac{2 \left(\sum_{c=1}^2 \frac{1}{W_c}  \right)^{2 }}{ (Var(V_1^R) + Var(V_2^R))} \\
            %  & = \frac{2 \left(E(V^R_1) + E(V^R_2)  \right)^{2 }}{ (Var(V_1^R) + Var(V_2^R))} \\
            & = \frac{2 \left(\sum_{c=1}^2 E(V^R_c)  \right)^{2 }}{ \sum_{c=1}^2 Var(V^R_c) } \\
              & = \frac{2 \times \left[ \left(E(V^R_1) + E(V^R_2)  \right) \right]^2}{\left(Var(V^R_1) + Var(V^R_2)  \right)} \\
    \end{split}
    \nonumber
\end{equation}
To simplify this further, we can express Equation \ref{eq: two_catdf} in terms of the degrees of freedom for one category (Proof found  in Appendix A) presented here: 
\begin{equation}
   \nu_c = \left[ \sum_{j = 1} ^{Jc} \frac{w^2_{jc}}{ (W_c - w_{jc}) ^2} - \frac{2}{W} \sum_{j = 1} ^{Jc} \frac{w_{jc}^3}{(W_c - w_{jc})^2} + \frac{1}{W_c^2} \left(\sum_{j = 1} ^{Jc} \frac{w_{jc}^2}{W-w_{jc}} \right)^2 \right]^{-1}.
   \nonumber
\end{equation}

Writing $\nu_c$ in terms of $Var(V_c^R)$ using the Satterthwaite degrees of freedom (Equation \ref{eq: satt formulation}) is:
 \begin{equation}
\begin{split}
    \nu_c &= \left[ Var(V_c^R) \times \frac{W_c^2}{2} \right]^{-1} \\
    \frac{1}{\nu_c} &= \frac{W^2_c}{2}Var(V_c^R) \\
    \frac{2}{W^2_c\nu_c} &= Var(V_c^R) \\
 \nonumber 
\end{split}
 \end{equation}
 
Then, the Satterthwaite degrees of freedom for a two-categorical moderator in terms of $\nu_c$ is:
\begin{equation} \label{eq: two_catdf in nu_c df terms}
    \begin{split}
    \zeta_{c=2} =& \frac{2 \times \left[ \left(E(V^R_1) + E(V^R_2)  \right) \right]^2}{\left(Var(V^R_1) + Var(V^R_2)  \right)} \\
     =& \frac{2 \times \left[ \left(E(V^R_1) + E(V^R_2)  \right) \right]^2}{\left(\frac{2}{W^2_1\nu_1} + \frac{2}{W^2_2\nu_2} \right)} \\
     =&
\frac{\left( \frac{1}{W_1} + \frac{1}{W_2} \right)^2}
{\frac{1}{W_1^2 \nu_1} + \frac{1}{W_2^2 \nu_2}}.
    \end{split}
    \nonumber
\end{equation}
